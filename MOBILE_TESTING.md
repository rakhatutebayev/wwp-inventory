# Инструкции по тестированию мобильного приложения

## Содержание
1. [Подготовка к тестированию](#подготовка-к-тестированию)
2. [Настройка окружения](#настройка-окружения)
3. [Запуск приложения](#запуск-приложения)
4. [Тестовые сценарии](#тестовые-сценарии)
5. [Известные проблемы и ограничения](#известные-проблемы-и-ограничения)

## Подготовка к тестированию

### Требования
- Node.js 18+ установлен
- Expo CLI установлен глобально: `npm install -g expo-cli`
- Expo Go приложение установлено на мобильном устройстве (iOS/Android)
- Backend сервер запущен и доступен
- Устройство и компьютер находятся в одной Wi-Fi сети

### Установка зависимостей

```bash
cd mobile
npm install
```

## Настройка окружения

### Настройка API URL

Перед тестированием на реальном устройстве необходимо настроить URL API сервера.

1. Откройте файл `mobile/src/services/api.js`
2. Найдите строку с `API_BASE_URL`
3. Замените `localhost` на IP-адрес вашего компьютера в локальной сети

**Важно:**
- Для **реального устройства** (iOS/Android): используйте IP-адрес вашего компьютера (например, `http://192.168.1.100:8000`)
- Для **Android эмулятора**: используйте `http://10.0.2.2:8000`
- Для **iOS симулятора**: используйте `http://localhost:8000`

**Как узнать IP-адрес вашего компьютера:**
- macOS/Linux: `ifconfig | grep "inet " | grep -v 127.0.0.1`
- Windows: `ipconfig` (ищите IPv4 адрес)

### Проверка доступности API

Убедитесь, что backend доступен с мобильного устройства:

```bash
# На компьютере с backend
# Проверьте, что сервер слушает на всех интерфейсах (0.0.0.0)
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

Проверьте доступность с мобильного устройства, открыв в браузере телефона:
`http://ВАШ_IP:8000/docs`

## Запуск приложения

### Способ 1: Через Expo Go (рекомендуется для тестирования)

1. Запустите Expo сервер:
```bash
cd mobile
npm start
```

2. Отсканируйте QR-код:
   - **iOS**: Откройте приложение Camera и отсканируйте QR-код
   - **Android**: Откройте приложение Expo Go и нажмите "Scan QR Code"

3. Приложение загрузится на ваше устройство

### Способ 2: Через эмулятор/симулятор

**Android:**
```bash
npm run android
```

**iOS (только macOS):**
```bash
npm run ios
```

**Web (для быстрой проверки UI):**
```bash
npm run web
```

## Тестовые сценарии

### 1. Аутентификация

#### 1.1 Вход в систему
**Шаги:**
1. Откройте приложение
2. На экране входа введите:
   - Имя пользователя: `admin` (или другое существующее)
   - Пароль: `admin123` (или соответствующий пароль)
3. Нажмите "Войти"

**Ожидаемый результат:**
- Приложение переходит на главный экран с вкладками
- Показывается список устройств (если они есть)

**Проверка ошибок:**
- Попробуйте войти с неверными данными
- Попробуйте оставить поля пустыми
- Проверьте сообщения об ошибках

### 2. Просмотр устройств

#### 2.1 Список устройств
**Шаги:**
1. После входа перейдите на вкладку "Устройства"
2. Просмотрите список устройств

**Ожидаемый результат:**
- Отображается список всех устройств
- Для каждого устройства показывается:
  - Инвентарный номер
  - Серийный номер
  - Тип устройства и бренд
  - Текущая локация (склад или сотрудник)

**Проверка:**
- Прокрутите список вниз
- Проверьте отображение при отсутствии устройств

#### 2.2 Поиск устройств
**Шаги:**
1. На вкладке "Устройства" используйте поисковую строку
2. Введите инвентарный или серийный номер

**Ожидаемый результат:**
- Список фильтруется по введенному запросу
- Поиск работает в реальном времени

#### 2.3 Детальная информация об устройстве
**Шаги:**
1. Нажмите на любое устройство в списке
2. Просмотрите детальную информацию

**Ожидаемый результат:**
- Отображается полная информация об устройстве:
  - Тип устройства
  - Бренд
  - Модель
  - Серийный номер
  - Инвентарный номер
  - Текущая локация
- Показывается история перемещений
- Есть кнопка "Переместить"

**Проверка:**
- Прокрутите историю перемещений
- Проверьте отображение дат в правильном формате

### 3. Сканирование QR-кодов

#### 3.1 Сканирование инвентарного номера
**Шаги:**
1. Перейдите на вкладку "Сканировать"
2. Разрешите доступ к камере (если запрашивается)
3. Наведите камеру на QR-код с инвентарным номером

**Ожидаемый результат:**
- Камера активируется
- После сканирования открывается экран с деталями устройства
- Если устройство не найдено, показывается сообщение об ошибке

**Проверка:**
- Попробуйте отсканировать несуществующий QR-код
- Проверьте работу кнопки "Сканировать снова"

**Примечание:** Для тестирования можно использовать любой QR-код генератор онлайн, создав QR-код с инвентарным номером существующего устройства.

#### 3.2 Разрешения камеры
**Шаги:**
1. При первом открытии вкладки "Сканировать" откройте настройки приложения
2. Отзовите разрешение на использование камеры
3. Вернитесь в приложение и попробуйте открыть сканер

**Ожидаемый результат:**
- Показывается сообщение о необходимости разрешения на камеру
- Приложение корректно обрабатывает отсутствие разрешения

### 4. Перемещения устройств

#### 4.1 Перемещение устройства на склад
**Шаги:**
1. Откройте детальную информацию об устройстве
2. Нажмите кнопку "Переместить"
3. Выберите тип локации "Склад"
4. Выберите конкретный склад из списка
5. Нажмите "Переместить"

**Ожидаемый результат:**
- Показывается форма выбора локации
- После выбора склада и подтверждения:
  - Показывается сообщение об успехе
  - Приложение возвращается на предыдущий экран
  - История перемещений обновляется
  - Текущая локация устройства обновляется

#### 4.2 Перемещение устройства сотруднику
**Шаги:**
1. Откройте детальную информацию об устройстве
2. Нажмите кнопку "Переместить"
3. Выберите тип локации "Сотрудник"
4. Выберите сотрудника из списка
5. Нажмите "Переместить"

**Ожидаемый результат:**
- Аналогично перемещению на склад
- В списке сотрудников отображаются ФИО и телефонный номер

**Проверка ошибок:**
- Попробуйте переместить устройство без выбора локации
- Проверьте валидацию формы

### 5. История перемещений

#### 5.1 Просмотр истории перемещений
**Шаги:**
1. Перейдите на вкладку "Перемещения"
2. Просмотрите список всех перемещений

**Ожидаемый результат:**
- Отображается список всех перемещений
- Для каждого перемещения показывается:
  - ID устройства
  - Откуда перемещено
  - Куда перемещено
  - Дата и время перемещения

**Проверка:**
- Прокрутите список
- Проверьте отображение при отсутствии перемещений
- Проверьте формат дат

### 6. Отчеты

#### 6.1 Отчет по локациям
**Шаги:**
1. Перейдите на вкладку "Отчеты"
2. Просмотрите отчет по локациям

**Ожидаемый результат:**
- Отображается список всех локаций (склады и сотрудники)
- Для каждой локации показывается:
  - Название локации
  - Количество устройств
  - Список устройств с инвентарными и серийными номерами

**Проверка:**
- Проверьте отображение при отсутствии устройств
- Проверьте корректность подсчета устройств

### 7. Навигация

#### 7.1 Переключение между вкладками
**Шаги:**
1. Переключайтесь между вкладками в нижней панели навигации

**Ожидаемый результат:**
- Плавное переключение между экранами
- Состояние экранов сохраняется при переключении
- Иконки и названия вкладок отображаются корректно

#### 7.2 Навигация назад
**Шаги:**
1. Откройте детальную информацию об устройстве
2. Используйте кнопку "Назад" (если доступна) или жест свайпа

**Ожидаемый результат:**
- Корректный возврат на предыдущий экран
- Состояние списка устройств сохраняется

### 8. Обработка ошибок

#### 8.1 Ошибки сети
**Шаги:**
1. Отключите Wi-Fi или мобильный интернет
2. Попробуйте выполнить любое действие, требующее сетевого запроса

**Ожидаемый результат:**
- Показывается понятное сообщение об ошибке
- Приложение не крашится
- После восстановления соединения можно повторить действие

#### 8.2 Неавторизованный доступ
**Шаги:**
1. Войдите в приложение
2. Удалите токен из AsyncStorage (через отладку) или дождитесь истечения токена
3. Попробуйте выполнить действие

**Ожидаемый результат:**
- При 401 ошибке пользователь перенаправляется на экран входа
- Токен удаляется из хранилища

## Известные проблемы и ограничения

### Текущие ограничения

1. **API URL**: Требует ручной настройки для работы на реальных устройствах
   - Решение: Используйте IP-адрес компьютера вместо localhost

2. **Отчеты**: Функционал отчетов базовый, без фильтрации
   - В будущих версиях планируется добавить фильтры и экспорт

3. **Создание устройств**: Не реализовано в мобильном приложении
   - Используйте веб-интерфейс для создания устройств

4. **Редактирование устройств**: Не реализовано в мобильном приложении
   - Используйте веб-интерфейс для редактирования

### Рекомендации по тестированию

1. **Тестируйте на реальных устройствах**: Эмуляторы могут работать иначе, чем реальные устройства
2. **Проверяйте на разных версиях ОС**: iOS и Android могут иметь различия в поведении
3. **Тестируйте в разных сетевых условиях**: Wi-Fi, 4G, медленное соединение
4. **Проверяйте работу при переключении между приложениями**: Приложение должно корректно восстанавливать состояние
5. **Тестируйте с разными размерами экранов**: Убедитесь, что UI адаптируется

## Чек-лист тестирования

- [ ] Установка зависимостей прошла успешно
- [ ] API URL настроен для тестируемого устройства
- [ ] Backend доступен с мобильного устройства
- [ ] Вход в систему работает
- [ ] Список устройств отображается корректно
- [ ] Поиск устройств работает
- [ ] Детальная информация об устройстве отображается
- [ ] Сканирование QR-кодов работает
- [ ] Перемещение на склад работает
- [ ] Перемещение сотруднику работает
- [ ] История перемещений отображается
- [ ] Отчеты отображаются корректно
- [ ] Навигация работает плавно
- [ ] Ошибки обрабатываются корректно
- [ ] Приложение работает при переключении между вкладками
- [ ] Приложение корректно обрабатывает потерю сети
- [ ] Приложение корректно обрабатывает истечение токена

## Отчет о найденных проблемах

При обнаружении проблем, пожалуйста, документируйте их с указанием:
- Описание проблемы
- Шаги для воспроизведения
- Ожидаемое поведение
- Фактическое поведение
- Версия ОС и устройства
- Скриншоты (если применимо)

## Дополнительные ресурсы

- [Expo документация](https://docs.expo.dev/)
- [React Navigation документация](https://reactnavigation.org/)
- [React Native Paper документация](https://callstack.github.io/react-native-paper/)



